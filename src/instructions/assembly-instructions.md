# PDF Assembly Instructions Implementation

## Current Status: ✅ FULLY IMPLEMENTED

This document describes the 5-page PDF assembly instruction system for the Kallax-style modular shelving configurator. All pages have been implemented with landscape letter format (792×612px).

**Key Components Implemented:**
- `src/geometry/pdfBooklet.ts` - Main PDF generation with pdf-lib
- `src/geometry/ripGenerator.ts` - Bin packing algorithm for sheet optimization  
- `src/geometry/cutListSvg.ts` - Technical SVG generation for cut sheets
- `src/geometry/gridSvg.ts` - Grid component SVG export
- `src/lib/svgToImage.ts` - SVG to PNG conversion for PDF embedding

**PDF Generation Process:**
1. Generate parts list from design parameters
2. Create sheet layouts using rip packing algorithm
3. Generate SVGs for cut sheets and grid
4. Convert SVGs to PNGs with proper scaling
5. Assemble 5-page PDF with embedded images

## Page Specifications

For each page, I will give a header area and a body area. the header area will always have a title and a subtitle. The rest of the content will vary depending on the page.
Please arrange these as landscape letter pages.

Page 1: 
Header
Title: {Title Input by Users}
Subtitle: {grid width x grid length} with {back or no back} and {no doors, inset doors, overlay doors}
Body
Ikea-guy (right-aligned even with header): src/assets/ikea-guy.png
Body Text (left-aligned): Overview for assembling a plywood modular shelving unit generated by {site url}. Note that this app does not generated detailed assembly instructions, but will give you an overview of your options.
Image (right-aligned): Axonometric View (from front above left) of the overall piece as configured, with dims for the exterior dimensions.

**Implementation Status:** ✅ Completed - Landscape letter format (792×612px) with proper layout

Page 2: 
Header
Title: Configurations + Pieces
Subtitle: Configurations set by user, and tabulated cut list
Body
Grid Configuration and Layout (as drawn on website, with coordinates etc)
Chart 1: All Configurations set by user. This is the grid layout, interior clearance (module size), depth, if it is has a back or not, doors, frame door and back thickness, door style, door reveal or overlay depending on the option. You can structure this as the same as the configurations panel
Chart 2: List of all parts to be cut

**Implementation Status:** ✅ Completed - Includes grid SVG export and configuration tables

Page 3:
Header
Title: Cut List
Subtitle: Suggestion for organizing cuts on 4' x 8' plywood sheet goods
Body
These drawings are suggestions for how one may lay out the parts on 4' x 8' sheet to minimize material waste. The packing algorithm used here is very basic, and should be double-checked. To try to plan for max rip lengths of various equipment - pieces with both dims below 24" are organized by their largest dim, and pieces with a dim above 24" are organized by their smallest. Lastly, the packing algorithm puts 1" in between cuts - this is so the user does not end up with small pieces due to the kerf of the blade, not to actually suggest you should put 1" in between cuts.
**Note - these dimensions may change depending on your preferred assembly method!! See next section**
Images: Cut sheet diagrams generated by the rip generator, showing 3 sheets per page with minimal spacing. Each sheet shows part placement, rip cut lines, and dimensions. Currently implements tight SVG generation with 40px margins, 20px title space, and automatic sheet sizing.

**Current Implementation Status:**
- ✅ Rip orientation rules based on 24" threshold
- ✅ First-fit decreasing packing algorithm  
- ✅ 1" margin between all cuts
- ✅ Grouping by material thickness
- ✅ SVG generation with part labels and rip lines
- ✅ Utilization percentage calculation
- ✅ PDF integration with 3 sheets per page
- ✅ Automatic overflow to additional sheets 

Page 4:
Header
Title: Connections and Assembly Methods
Subtitle: Suggestions for how to assemble
Body
For now, please a brief summary of considerations one might make for 
- dados (including making dims longer to account for amount that the parts sit into other parts. For 3/4" ply, I use 1/8" dados in cases where a part is receiving another part on either side like shelves into the vertical dividers (leaving approx 1/2" of material), and 1/4" dados for cases where a part goes into into an end piece, like the top bottom and sides, leaving 1/2" of material.)
And an overview of butt joints like:
- hidden screws
- pocket screws
- glued dowels

**Implementation Status:** ✅ Completed - Text content with assembly method recommendations

Page 5:
Header
Title: Thank you!
Body
Hope this helps. If you have any images to share of what to build, send them to me at adamvosburgh@gmail.com!

**Implementation Status:** ✅ Completed - Simple thank you page with contact information


-- answers to questions

  Questions about the PDF/Rip Generator Approach:

  1. Image Generation Priority: For Page 1, the instructions mention both ikea-guy.png and an axonometric view.
  Should these be side-by-side, or stacked vertically? And what's the priority sizing between them? Good question, that got a bit confusing. I updated the instructions below, but the ikea guy should be relatively small and inline with the header. The axonometric should take the majority of available space before that, and the body text should be to the left of it.
  2. Grid Visualization: On Page 2, when showing the "Grid Configuration and Layout (as drawn on website)", do
  you want this to be the same interactive grid component rendered as SVG, or a simplified schematic? The same one rendered as SVG. might as well re-use, so when i make future changes to it they'll show up here too.
  3. Site URL Reference: The instructions mention "{site url}" - what should I use as the placeholder or do you
  have a specific URL? items in curly brackets are variabless I was thinking. I dont' have a url currently, but i am guessing you'll be able to grab one from one of the config files once I set up those build instructions?
  4. Rip Generator Output: You want the cut list images "sized to 80% of page height, organized next to each
  other with no margin" - if there are multiple thickness sheets (3/4", 1/4", etc.), should they be arranged
  horizontally in rows, or should each thickness get its own page? The page is landscape, so by 80% height I was assuming we could fit three sheets or so on a page. Let's just say three sheets per page and you can figure out the specifics.
  5. Error Handling: For the packing algorithm, if pieces don't fit efficiently on standard 4'x8' sheets, should
   we automatically create additional sheets or show a warning? Just cvreate additional sheets. We're just trying to do our best here.
  6. Part Consolidation: Should identical parts (like multiple doors of the same size) be combined in the visual
   layout, or shown as separate rectangles? shown as seperate rectangles - we need to cut all of them!
